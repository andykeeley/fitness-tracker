{% extends "base.html" %}

{% block title %}Workout Summary - Andy's Fitness Hub{% endblock %}

{% block content %}
<div class="workout-summary">
    <h1>Workout Summary</h1>

    <div class="summary-header">
        <div class="workout-type-badge large">
            {% if workout.workout_type == 'strength' %}üèãÔ∏è Strength Training
            {% elif workout.workout_type == 'circuit' %}‚ö° Circuit Training
            {% else %}üèÉ Run{% endif %}
        </div>
        <div class="workout-date">{{ workout.date }}</div>
        {% if duration %}
        <div class="workout-duration-display">
            <span class="duration-icon">‚è±Ô∏è</span>
            <span class="duration-value">{{ duration }} min</span>
        </div>
        {% endif %}
    </div>

    {% if workout.workout_type == 'run' %}
    <!-- Run Summary -->
    <div class="summary-card">
        <div class="run-stats">
            {% if workout.distance_km %}
            <div class="stat">
                <span class="stat-value">{{ "%.2f"|format(workout.distance_km) }}</span>
                <span class="stat-label">km</span>
            </div>
            {% endif %}
            {% if workout.duration_minutes %}
            <div class="stat">
                <span class="stat-value">{{ workout.duration_minutes }}</span>
                <span class="stat-label">minutes</span>
            </div>
            {% endif %}
            {% if workout.distance_km and workout.duration_minutes %}
            {% set pace = workout.duration_minutes / workout.distance_km %}
            <div class="stat">
                <span class="stat-value">{{ "%d:%02d"|format(pace|int, ((pace - pace|int) * 60)|int) }}</span>
                <span class="stat-label">/km pace</span>
            </div>
            {% endif %}
        </div>
    </div>
    {% else %}
    <!-- Strength/Circuit Summary -->
    {% if exercises %}
    <div class="summary-exercises">
        {% for item in exercises %}
        <div class="summary-exercise">
            <h3>{{ item.exercise.name }}</h3>
            {% if item.sets %}
            <div class="summary-sets">
                {% for set in item.sets %}
                <span class="summary-set">{{ set.reps }} √ó {{ set.weight }}kg</span>
                {% endfor %}
            </div>
            {% else %}
            <p class="no-sets">No sets recorded</p>
            {% endif %}
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div class="empty-summary">
        <p>No exercises recorded for this workout.</p>
    </div>
    {% endif %}
    {% endif %}

    <!-- Notes Form -->
    <form method="POST" action="{{ url_for('finish_workout', workout_id=workout.id) }}" class="notes-form">
        {% if duration %}
        <input type="hidden" name="duration_minutes" value="{{ duration }}">
        {% endif %}
        <div class="form-group">
            <label for="notes">Session Notes (optional)</label>
            <textarea id="notes" name="notes" rows="3" placeholder="How did it go? Any feedback or observations?">{{ workout.notes or '' }}</textarea>
        </div>

        <div class="summary-actions">
            {% if workout.workout_type == 'run' %}
            <a href="{{ url_for('active_run', workout_id=workout.id) }}" class="btn btn-secondary">Back to Edit</a>
            {% else %}
            <a href="{{ url_for('active_workout', workout_id=workout.id) }}" class="btn btn-secondary">Back to Edit</a>
            {% endif %}
            <button type="submit" class="btn btn-primary btn-finish">Save Workout</button>
        </div>
    </form>
</div>
{% endblock %}
